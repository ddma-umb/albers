(()=>{var r={243:r=>{if(!n)var n={map:function(r,n){var o={};return n?r.map((function(r,t){return o.index=t,n.call(o,r)})):r.slice()},naturalOrder:function(r,n){return r<n?-1:r>n?1:0},sum:function(r,n){var o={};return r.reduce(n?function(r,t,e){return o.index=e,r+n.call(o,t)}:function(r,n){return r+n},0)},max:function(r,o){return Math.max.apply(null,o?n.map(r,o):r)}};var o=function(){function r(r,n,o){return(r<<10)+(n<<5)+o}function o(r){var n=[],o=!1;function t(){n.sort(r),o=!0}return{push:function(r){n.push(r),o=!1},peek:function(r){return o||t(),void 0===r&&(r=n.length-1),n[r]},pop:function(){return o||t(),n.pop()},size:function(){return n.length},map:function(r){return n.map(r)},debug:function(){return o||t(),n}}}function t(r,n,o,t,e,u,i){var a=this;a.r1=r,a.r2=n,a.g1=o,a.g2=t,a.b1=e,a.b2=u,a.histo=i}function e(){this.vboxes=new o((function(r,o){return n.naturalOrder(r.vbox.count()*r.vbox.volume(),o.vbox.count()*o.vbox.volume())}))}function u(o,t){if(t.count()){var e=t.r2-t.r1+1,u=t.g2-t.g1+1,i=t.b2-t.b1+1,a=n.max([e,u,i]);if(1==t.count())return[t.copy()];var c,f,s,v,p=0,l=[],b=[];if(a==e)for(c=t.r1;c<=t.r2;c++){for(v=0,f=t.g1;f<=t.g2;f++)for(s=t.b1;s<=t.b2;s++)v+=o[r(c,f,s)]||0;p+=v,l[c]=p}else if(a==u)for(c=t.g1;c<=t.g2;c++){for(v=0,f=t.r1;f<=t.r2;f++)for(s=t.b1;s<=t.b2;s++)v+=o[r(f,c,s)]||0;p+=v,l[c]=p}else for(c=t.b1;c<=t.b2;c++){for(v=0,f=t.r1;f<=t.r2;f++)for(s=t.g1;s<=t.g2;s++)v+=o[r(f,s,c)]||0;p+=v,l[c]=p}return l.forEach((function(r,n){b[n]=p-r})),function(r){var n,o,e,u,i,a=r+"1",f=r+"2",s=0;for(c=t[a];c<=t[f];c++)if(l[c]>p/2){for(e=t.copy(),u=t.copy(),i=(n=c-t[a])<=(o=t[f]-c)?Math.min(t[f]-1,~~(c+o/2)):Math.max(t[a],~~(c-1-n/2));!l[i];)i++;for(s=b[i];!s&&l[i-1];)s=b[--i];return e[f]=i,u[a]=e[f]+1,[e,u]}}(a==e?"r":a==u?"g":"b")}}return t.prototype={volume:function(r){var n=this;return n._volume&&!r||(n._volume=(n.r2-n.r1+1)*(n.g2-n.g1+1)*(n.b2-n.b1+1)),n._volume},count:function(n){var o=this,t=o.histo;if(!o._count_set||n){var e,u,i,a=0;for(e=o.r1;e<=o.r2;e++)for(u=o.g1;u<=o.g2;u++)for(i=o.b1;i<=o.b2;i++)a+=t[r(e,u,i)]||0;o._count=a,o._count_set=!0}return o._count},copy:function(){var r=this;return new t(r.r1,r.r2,r.g1,r.g2,r.b1,r.b2,r.histo)},avg:function(n){var o=this,t=o.histo;if(!o._avg||n){var e,u,i,a,c=0,f=0,s=0,v=0;for(u=o.r1;u<=o.r2;u++)for(i=o.g1;i<=o.g2;i++)for(a=o.b1;a<=o.b2;a++)c+=e=t[r(u,i,a)]||0,f+=e*(u+.5)*8,s+=e*(i+.5)*8,v+=e*(a+.5)*8;o._avg=c?[~~(f/c),~~(s/c),~~(v/c)]:[~~(8*(o.r1+o.r2+1)/2),~~(8*(o.g1+o.g2+1)/2),~~(8*(o.b1+o.b2+1)/2)]}return o._avg},contains:function(r){var n=this,o=r[0]>>3;return gval=r[1]>>3,bval=r[2]>>3,o>=n.r1&&o<=n.r2&&gval>=n.g1&&gval<=n.g2&&bval>=n.b1&&bval<=n.b2}},e.prototype={push:function(r){this.vboxes.push({vbox:r,color:r.avg()})},palette:function(){return this.vboxes.map((function(r){return r.color}))},size:function(){return this.vboxes.size()},map:function(r){for(var n=this.vboxes,o=0;o<n.size();o++)if(n.peek(o).vbox.contains(r))return n.peek(o).color;return this.nearest(r)},nearest:function(r){for(var n,o,t,e=this.vboxes,u=0;u<e.size();u++)((o=Math.sqrt(Math.pow(r[0]-e.peek(u).color[0],2)+Math.pow(r[1]-e.peek(u).color[1],2)+Math.pow(r[2]-e.peek(u).color[2],2)))<n||void 0===n)&&(n=o,t=e.peek(u).color);return t},forcebw:function(){var r=this.vboxes;r.sort((function(r,o){return n.naturalOrder(n.sum(r.color),n.sum(o.color))}));var o=r[0].color;o[0]<5&&o[1]<5&&o[2]<5&&(r[0].color=[0,0,0]);var t=r.length-1,e=r[t].color;e[0]>251&&e[1]>251&&e[2]>251&&(r[t].color=[255,255,255])}},{quantize:function(i,a){if(!i.length||a<2||a>256)return!1;var c=function(n){var o,t,e,u,i=new Array(32768);return n.forEach((function(n){t=n[0]>>3,e=n[1]>>3,u=n[2]>>3,o=r(t,e,u),i[o]=(i[o]||0)+1})),i}(i);c.forEach((function(){}));var f=function(r,n){var o,e,u,i=1e6,a=0,c=1e6,f=0,s=1e6,v=0;return r.forEach((function(r){o=r[0]>>3,e=r[1]>>3,u=r[2]>>3,o<i?i=o:o>a&&(a=o),e<c?c=e:e>f&&(f=e),u<s?s=u:u>v&&(v=u)})),new t(i,a,c,f,s,v,n)}(i,c),s=new o((function(r,o){return n.naturalOrder(r.count(),o.count())}));function v(r,n){for(var o,t=1,e=0;e<1e3;)if((o=r.pop()).count()){var i=u(c,o),a=i[0],f=i[1];if(!a)return;if(r.push(a),f&&(r.push(f),t++),t>=n)return;if(e++>1e3)return}else r.push(o),e++}s.push(f),v(s,.75*a);for(var p=new o((function(r,o){return n.naturalOrder(r.count()*r.volume(),o.count()*o.volume())}));s.size();)p.push(s.pop());v(p,a-p.size());for(var l=new e;p.size();)l.push(p.pop());return l}}}();r.exports=o.quantize},925:(r,n,o)=>{"use strict";o(243)}},n={};function o(t){if(n[t])return n[t].exports;var e=n[t]={exports:{}};return r[t](e,e.exports,o),e.exports}o.n=r=>{var n=r&&r.__esModule?()=>r.default:()=>r;return o.d(n,{a:n}),n},o.d=(r,n)=>{for(var t in n)o.o(n,t)&&!o.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:n[t]})},o.o=(r,n)=>Object.prototype.hasOwnProperty.call(r,n),o(925)})();